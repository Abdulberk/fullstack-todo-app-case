{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Taha/Desktop/MERN-todo-case-project/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Taha/Desktop/MERN-todo-case-project/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Taha/Desktop/MERN-todo-case-project/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _taggedTemplateLiteral from\"C:/Users/Taha/Desktop/MERN-todo-case-project/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2;import React,{useEffect}from'react';import{useDispatch,useSelector}from'react-redux';import{useNavigate}from'react-router-dom';import{useGetTodosQuery}from'../api/todosApi';import NewTodo from'../components/Todo';import styled from'styled-components';import SyncLoader from'react-spinners/SyncLoader';import{setTodos}from'../redux/slices/todoSlice';import{useDeleteTodoMutationMutation}from'../api/todosApi';import{deleteTodo}from'../redux/slices/todoSlice';import{jsx as _jsx}from\"react/jsx-runtime\";var DashboardContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: repeat(4, 1fr);\\n  width: 100%;\\n  max-width: 1440px;\\n  margin: 0 auto;\\n  padding: 20px;\\n  height: 100%;\\n  min-height: 100vh;\\n  min-width: 320px;\\n\\n\\n  @media (min-width: 1024px) and (max-width: 1439px)) {\\n    grid-template-columns: repeat(3, 1fr);\\n    gap: 20px;\\n  \\n    justify-items: center; \\n  }\\n\\n  @media (min-width: 768px) and (max-width: 1023px)) {\\n    grid-template-columns: repeat(2, 1fr);\\n   \\n    justify-items: center; \\n  }\\n\\n  @media (max-width: 767px) {\\n    grid-template-columns: repeat(1, 1fr);\\n    justify-items: center; \\n  }\\n\\n  @media (max-width: 320px) {\\n    grid-template-columns: repeat(1, 1fr);\\n    justify-items: center;\\n  }\\n\\n  @media (min-width: 1441px) {\\n    grid-template-columns: repeat(5, 1fr);\\n    gap: 20px;\\n    justify-items: center;\\n  }\\n\\n\\n\"])));var TodoWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: repeat(4, 1fr);\\n  gap: 40px;\\n\\n\\n  @media (min-width: 1024px) and (max-width: 1439px) {\\n    grid-template-columns: repeat(3, 1fr);\\n    \\n  }\\n\\n  @media (min-width: 768px) and (max-width: 1023px) {\\n    grid-template-columns: repeat(2, 1fr);\\n\\n    \\n  }\\n\\n  @media (max-width: 767px) {\\n    grid-template-columns: repeat(1, 1fr);\\n\\n  }\\n\\n  @media (max-width: 320px) {\\n    grid-template-columns: repeat(1, 1fr);\\n\\n  }\\n\\n  @media (min-width: 1441px) {\\n    grid-template-columns: repeat(5, 1fr);\\n    gap: 20px;\\n  }\\n\\n\"])));var Dashboard=function Dashboard(){var token=localStorage.getItem('token');var dispatch=useDispatch();var navigate=useNavigate();var _useGetTodosQuery=useGetTodosQuery(),todos=_useGetTodosQuery.data,error=_useGetTodosQuery.error,isLoading=_useGetTodosQuery.isLoading,isSuccess=_useGetTodosQuery.isSuccess;var todosState=useSelector(function(state){return state.todos.todos;});var _useDeleteTodoMutatio=useDeleteTodoMutationMutation(),_useDeleteTodoMutatio2=_slicedToArray(_useDeleteTodoMutatio,1),deleteTodoMutation=_useDeleteTodoMutatio2[0];useEffect(function(){if(isSuccess){dispatch(setTodos(todos.myTodos));}},[dispatch,isSuccess,todos]);useEffect(function(){if(!token){navigate('/login');}},[token,navigate]);if(!token){return null;}if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsx(SyncLoader,{color:\"#3B82F6\",size:\"15\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{children:\"An error occurred, please refresh the page\"});}var handleDeleteTodo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(todoId){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return deleteTodoMutation({todoId:todoId});case 3:dispatch(deleteTodo({todoId:todoId}));dispatch(setTodos(todosState.filter(function(todo){return todo._id!==todoId;})));_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function handleDeleteTodo(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(DashboardContainer,{children:todosState.length>0?/*#__PURE__*/_jsx(TodoWrapper,{children:todosState.map(function(todo){return/*#__PURE__*/_jsx(NewTodo,{todo:todo,onDelete:handleDeleteTodo},todo._id);})}):/*#__PURE__*/_jsx(\"p\",{children:\"No todos found\"})});};export default Dashboard;","map":{"version":3,"names":["React","useEffect","useDispatch","useSelector","useNavigate","useGetTodosQuery","NewTodo","styled","SyncLoader","setTodos","useDeleteTodoMutationMutation","deleteTodo","jsx","_jsx","DashboardContainer","div","_templateObject","_taggedTemplateLiteral","TodoWrapper","_templateObject2","Dashboard","token","localStorage","getItem","dispatch","navigate","_useGetTodosQuery","todos","data","error","isLoading","isSuccess","todosState","state","_useDeleteTodoMutatio","_useDeleteTodoMutatio2","_slicedToArray","deleteTodoMutation","myTodos","className","children","color","size","handleDeleteTodo","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","todoId","wrap","_callee$","_context","prev","next","filter","todo","_id","t0","console","log","stop","_x","apply","arguments","length","map","onDelete"],"sources":["C:/Users/Taha/Desktop/MERN-todo-case-project/frontend/src/pages/Dashboard.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useGetTodosQuery } from '../api/todosApi';\r\nimport { Todo } from '../types/Todo';\r\nimport NewTodo from '../components/Todo';\r\nimport styled from 'styled-components';\r\nimport SyncLoader from 'react-spinners/SyncLoader';\r\nimport { setTodos } from '../redux/slices/todoSlice';\r\nimport { useDeleteTodoMutationMutation } from '../api/todosApi';\r\nimport { deleteTodo } from '../redux/slices/todoSlice';\r\n\r\n\r\nconst DashboardContainer = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(4, 1fr);\r\n  width: 100%;\r\n  max-width: 1440px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  height: 100%;\r\n  min-height: 100vh;\r\n  min-width: 320px;\r\n\r\n\r\n  @media (min-width: 1024px) and (max-width: 1439px)) {\r\n    grid-template-columns: repeat(3, 1fr);\r\n    gap: 20px;\r\n  \r\n    justify-items: center; \r\n  }\r\n\r\n  @media (min-width: 768px) and (max-width: 1023px)) {\r\n    grid-template-columns: repeat(2, 1fr);\r\n   \r\n    justify-items: center; \r\n  }\r\n\r\n  @media (max-width: 767px) {\r\n    grid-template-columns: repeat(1, 1fr);\r\n    justify-items: center; \r\n  }\r\n\r\n  @media (max-width: 320px) {\r\n    grid-template-columns: repeat(1, 1fr);\r\n    justify-items: center;\r\n  }\r\n\r\n  @media (min-width: 1441px) {\r\n    grid-template-columns: repeat(5, 1fr);\r\n    gap: 20px;\r\n    justify-items: center;\r\n  }\r\n\r\n\r\n`;\r\n\r\nconst TodoWrapper = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(4, 1fr);\r\n  gap: 40px;\r\n\r\n\r\n  @media (min-width: 1024px) and (max-width: 1439px) {\r\n    grid-template-columns: repeat(3, 1fr);\r\n    \r\n  }\r\n\r\n  @media (min-width: 768px) and (max-width: 1023px) {\r\n    grid-template-columns: repeat(2, 1fr);\r\n\r\n    \r\n  }\r\n\r\n  @media (max-width: 767px) {\r\n    grid-template-columns: repeat(1, 1fr);\r\n\r\n  }\r\n\r\n  @media (max-width: 320px) {\r\n    grid-template-columns: repeat(1, 1fr);\r\n\r\n  }\r\n\r\n  @media (min-width: 1441px) {\r\n    grid-template-columns: repeat(5, 1fr);\r\n    gap: 20px;\r\n  }\r\n\r\n`;\r\n\r\nconst Dashboard = () => {\r\n  const token = localStorage.getItem('token');\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  const { data: todos, error, isLoading, isSuccess } = useGetTodosQuery();\r\n  const todosState = useSelector((state: any) => state.todos.todos);\r\n\r\n\r\n\r\n\r\n\r\n  const [deleteTodoMutation\r\n  ] = useDeleteTodoMutationMutation();\r\n\r\n\r\n  useEffect(() => {\r\n    if (isSuccess) {\r\n      dispatch(setTodos(todos.myTodos));\r\n    }\r\n  }, [dispatch, isSuccess, todos]);\r\n\r\n  useEffect(() => {\r\n    if (!token) {\r\n      navigate('/login');\r\n    }\r\n  }, [token, navigate]);\r\n\r\n  if (!token) {\r\n    return null;\r\n  }\r\n\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-screen\">\r\n        <SyncLoader color=\"#3B82F6\" size=\"15\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return <div>An error occurred, please refresh the page</div>;\r\n  }\r\n\r\n    const handleDeleteTodo = async(todoId: string) => {\r\n\r\n    try {\r\n       await deleteTodoMutation({todoId})\r\n\r\n        dispatch(deleteTodo({\r\n          todoId: todoId\r\n        }))\r\n        dispatch(setTodos(todosState.filter((todo: Todo) => todo._id !== todoId)));\r\n  \r\n    }\r\n    catch(err) {\r\n      console.log(err)\r\n    }\r\n\r\n    }\r\n\r\n\r\n  return (\r\n    <DashboardContainer>\r\n      \r\n      {todosState.length > 0 ? (\r\n        <TodoWrapper>\r\n          {todosState.map((todo: Todo) => (\r\n            <NewTodo key={todo._id} todo={todo} onDelete = {handleDeleteTodo} />\r\n          ))}\r\n        </TodoWrapper>\r\n      ) : (\r\n        <p>No todos found</p>\r\n      )}\r\n       \r\n   \r\n    </DashboardContainer>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}